Biprocess 0 (that is, the initial process):
{1}new nonce: bitstring;
{2}new m: bitstring;
{3}out(c, (m,choice[nonce,h(m)]))

-- Observational equivalence in biprocess 0.
Translating the process into Horn clauses...
Termination warning: v ≠ v_1 && attacker2(v_2,v) && attacker2(v_2,v_1) -> bad
Selecting 0
Termination warning: v ≠ v_1 && attacker2(v,v_2) && attacker2(v_1,v_2) -> bad
Selecting 0
Completing...
Termination warning: v ≠ v_1 && attacker2(v_2,v) && attacker2(v_2,v_1) -> bad
Selecting 0
Termination warning: v ≠ v_1 && attacker2(v,v_2) && attacker2(v_1,v_2) -> bad
Selecting 0
goal reachable: bad

Derivation:

1. The message (m[],nonce[]) (resp. (m[],h(m[]))) may be sent to the attacker at output {3}.
attacker2((m[],nonce[]),(m[],h(m[]))).

2. By 1, the attacker may know (m[],nonce[]) (resp. (m[],h(m[]))).
Using the function 2-proj-2-tuple the attacker may obtain nonce[] (resp. h(m[])).
attacker2(nonce[],h(m[])).

3. By 1, the attacker may know (m[],nonce[]) (resp. (m[],h(m[]))).
Using the function 1-proj-2-tuple the attacker may obtain m[] (resp. m[]).
attacker2(m[],m[]).

4. By 3, the attacker may know m[] (resp. m[]).
Using the function h the attacker may obtain h(m[]) (resp. h(m[])).
attacker2(h(m[]),h(m[])).

5. By 4, the attacker may know h(m[]) (resp. h(m[])).
By 2, the attacker may know nonce[] (resp. h(m[])).
We have h(m[]) ≠ nonce[].
The attacker tests equality between the two terms he knows, which may allow it to distinguish cases.
bad.


A more detailed output of the traces is available with
  set traceDisplay = long.

new nonce: bitstring creating nonce_1 at {1}

new m: bitstring creating m_1 at {2}

out(c, (~M,~M_1)) with ~M = m_1, ~M_1 = choice[nonce_1,h(m_1)] at {3}

The attacker tests whether
h(~M) = h(m_1)
is equal to
~M_1 = choice[nonce_1,h(m_1)].
The result in the left-hand side is different from the result in the right-hand side.
A trace has been found.
RESULT Observational equivalence cannot be proved.
Looking for simplified processes ...
No simplified process found.

--------------------------------------------------------------
Verification summary:

Observational equivalence cannot be proved.

--------------------------------------------------------------

